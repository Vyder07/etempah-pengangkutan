<!DOCTYPE html>
<html lang="ms">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Profil Staf</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.13/cropper.min.css"/>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap" rel="stylesheet">
  <style>
    *{margin:0;padding:0;box-sizing:border-box;font-family:"Poppins",sans-serif;}
    body{height:100vh;width:100%;background:url('/IMG/Car1.jpg') no-repeat center center fixed;background-size:cover;}
    .sidebar{position:fixed;top:0;left:0;width:260px;height:100%;background:rgba(255,255,255,0.2);backdrop-filter:blur(17px);border-right:1px solid rgba(255,255,255,0.7);display:flex;flex-direction:column;padding:20px 0;}
    .logo{display:flex;align-items:center;padding:0 20px;color:#000;}
    .logo img{width:43px;border-radius:50%;}
    .logo h2{font-size:1.15rem;font-weight:600;margin-left:15px;}
    .links{list-style:none;padding:0 8px;}
    .links li{display:flex;align-items:center;border-radius:4px;padding:10px;transition:background 0.3s;}
    .links li:hover{cursor:pointer;background:rgba(255,255,255,0.12);}
    .links li span{padding-right:10px;font-size:24px;color:#000;}
    .links li a{color:#000;text-decoration:none;font-weight:500;white-space:nowrap;}
    .links li.active{background:#0734bb;border-left:4px solid #fff;}
    .links li.active a,.links li.active span{color:#fff;font-weight:600;}
    .bottom-links{margin-top:auto;}
    .topbar{position:fixed;left:260px;right:0;top:0;height:64px;display:flex;align-items:center;padding:0 18px;background:transparent;z-index:999;}
    .search-wrap{max-width:1100px;width:100%;display:flex;gap:8px;background:#ffffff;padding:8px;border-radius:8px}
    .search-input{flex:1;padding:8px 12px;border:1px solid #e5e7eb;border-radius:8px;font-size:14px;background:#fff}
    .search-btn{padding:8px 12px;border-radius:8px;border:1px solid #e5e7eb;background:#0b63ff;color:#fff;cursor:pointer}
    .content{margin-left:260px;margin-top:84px;display:flex;justify-content:center;align-items:flex-start;gap:30px;padding:20px;flex-wrap:wrap;}
    .card{background:rgba(255,255,255,0.95);border-radius:15px;box-shadow:0px 4px 10px rgba(0,0,0,0.2);padding:20px;}
    .card.profile{width:340px;text-align:center;}
    .profile-container{position:relative;display:inline-block;margin-bottom:10px;}
    .profile-container img{width:120px;height:120px;border-radius:50%;object-fit:cover;background:#eee;cursor:default;border:3px solid #0c48fe;}
    .upload-btn{position:absolute;bottom:0;right:0;background:rgb(9,30,255);color:white;border-radius:50%;padding:6px;font-size:14px;cursor:pointer;}
    input[type="file"]{display:none;}
    .role{color:red;font-weight:bold;margin-bottom:15px;}
    label{font-weight:bold;display:block;margin-top:10px;text-align:left;}
    input{width:100%;padding:8px;border-radius:8px;border:1px solid #ccc;background:#eee;}
    .card.profile button{margin-top:15px;width:100%;padding:10px;background:#0c48fe;color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:bold;}
    .card.profile button:hover{background:#0734bb;}
    .card.project{width:500px;text-align:left;}
    .project-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:15px;}
    .project-header img{max-height:50px;}
    /* Modal crop */
    #cropModal{display:none;position:fixed;inset:0;background:rgba(0,0,0,0.6);justify-content:center;align-items:center;z-index:9999;}
    #cropBox{background:white;padding:20px;border-radius:10px;max-width:500px;text-align:center;}
    #cropBox img{max-width:100%;max-height:400px;display:block;margin:0 auto;}
    .crop-actions{margin-top:10px;text-align:right;}
    .btn{padding:8px 14px;border-radius:8px;border:1px solid #ccc;background:#f5f5f5;cursor:pointer;}
    .btn.primary{background:#0c48fe;color:#fff;border-color:#0c48fe;}
  </style>
</head>
<body>
  <aside class="sidebar">
    <div class="logo">
      <img src="/IMG/PROTON.png" alt="logo">
      <h2>Staff</h2>
    </div>
    <ul class="links main-links">
      <li><span class="material-symbols-outlined">dashboard</span><a href="/staff/pages/main/dashboard.html">Laman Utama</a></li>
      <li><span class="material-symbols-outlined">calendar_month</span><a href="/staff/pages/main/Booking.html">Kalendar Tempahan</a></li>
      <li><span class="material-symbols-outlined">notifications</span><a href="/staff/pages/main/notification.html">Notifikasi Jawapan</a></li>
      <li><span class="material-symbols-outlined">library_books</span><a href="/staff/pages/main/vehicle.html">Senarai Dokumen</a></li>
    </ul>
    <ul class="links bottom-links">
      <li class="active"><span class="material-symbols-outlined">person</span><a href="#">Profil</a></li>
      <li class="logout-link"><span class="material-symbols-outlined">logout</span><a href="#">Log Keluar</a></li>
    </ul>
  </aside>

  <header class="topbar">
    <div class="search-wrap">
      <input id="globalSearch" class="search-input" type="search" placeholder="Search site..." />
      <button class="search-btn" type="button" onclick="alert('Fungsi carian belum siap')">üîç</button>
    </div>
  </header>

  <main class="content">
    <div class="card profile">
      <div class="profile-container">
        <img id="profilePic" src="/img/person.png" alt="Avatar">
        <label for="uploadPic" class="upload-btn">üì∑</label>
        <input type="file" id="uploadPic" accept="image/*">
      </div>
      <h3 id="nameDisplay">Pn. Aina</h3>
      <p class="role">Peranan: STAFF</p>
      <p id="emailDisplay">aina@example.com</p>
      <button id="editBtn">Edit Profile</button>
    </div>

    <div class="card project">
      <div class="project-header">
        <img src="/IMG/PROTON.png" alt="Proton">
        <img src="/IMG/ADTCMLK.png" alt="ADTEC">
      </div>
      <h3>Maklumat Akaun</h3>
      <div id="accountForm">
        <label for="accountName">Nama</label>
        <input id="accountName" type="text" value="Pn. Aina">
        <label for="accountEmail">Email</label>
        <input id="accountEmail" type="email" value="aina@example.com">
      </div>
    </div>
  </main>

  <!-- Modal Crop -->
  <div id="cropModal">
    <div id="cropBox">
      <h3>Crop Gambar Profil</h3>
      <img id="imageToCrop">
      <div class="crop-actions">
        <button id="cancelCrop" class="btn">Batal</button>
        <button id="saveCrop" class="btn primary">Simpan</button>
      </div>
    </div>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.13/cropper.min.js"></script>
  <script>
    let cropper;
    const uploadPic = document.getElementById('uploadPic');
    const profilePic = document.getElementById('profilePic');
    const cropModal = document.getElementById('cropModal');
    const imageToCrop = document.getElementById('imageToCrop');
    const cancelBtn = document.getElementById('cancelCrop');
    const saveBtn = document.getElementById('saveCrop');

    // bila user pilih gambar
    uploadPic.addEventListener('change', (e) => {
      const file = e.target.files[0];
      if (!file) return;

      const reader = new FileReader();
      reader.onload = function (event) {
        imageToCrop.src = event.target.result;
        cropModal.style.display = 'flex';
        if (cropper) cropper.destroy();
        cropper = new Cropper(imageToCrop, {
          aspectRatio: 1,
          viewMode: 1,
          background: false,
        });
      };
      reader.readAsDataURL(file);
    });

    // bila klik BATAL
    cancelBtn.addEventListener('click', () => {
      cropModal.style.display = 'none';
      if (cropper) cropper.destroy();
    });

    // bila klik SIMPAN
    saveBtn.addEventListener('click', () => {
      const canvas = cropper.getCroppedCanvas({
        width: 200,
        height: 200,
      });

      // tukar jadi gambar profil
      profilePic.src = canvas.toDataURL('image/png');
      cropModal.style.display = 'none';
      cropper.destroy();
    });
  </script>
</body>
</html>
